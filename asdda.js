var Skins = {
    hornet: {
        or: {
            meta: "/566/70102/323/346/31033607367072/meta.info",
            lightmap: "/566/70102/323/346/31033607367072/lightmap.webp",
            object: "/566/70102/323/346/31033607367072/object.a3d"
        },
        pr: {
            meta: "/553/1466/317/276/31033607413764/meta.info",
            lightmap: "/553/1466/317/276/31033607413764/lightmap.webp",
            object: "/553/1466/317/276/31033607413764/object.a3d"
        },
        lc: {
            meta: "/551/32007/310/225/31033607400400/meta.info",
            lightmap: "/551/32007/310/225/31033607400400/lightmap.webp",
            object: "/551/32007/310/225/31033607400400/object.a3d"
        },
        ut: {
            meta: "/562/165115/303/236/31033610210055/meta.info",
            lightmap: "/562/165115/303/236/31033610210055/lightmap.webp",
            object: "/562/165115/303/236/31033610210055/object.a3d"
        },
        gt: {
            meta: "/605/27506/77/216/31033607347661/meta.info",
            lightmap: "/605/27506/77/216/31033607347661/lightmap.webp",
            object: "/605/27506/77/216/31033607347661/object.a3d",
            wheels: "/605/27506/77/216/31033607347661/wheels.webp"
        },
        xt: {
            meta: "/0/16722/6/305/31033607424605/meta.info",
            lightmap: "/0/16722/6/305/31033607424605/lightmap.webp",
            object: "/0/16722/6/305/31033607424605/object.a3d"
        }
    },
    wasp: {
        or: {
            meta: "/574/111243/33/322/31033607311775/meta.info",
            lightmap: "/574/111243/33/322/31033607311775/lightmap.webp",
            object: "/574/111243/33/322/31033607311775/object.a3d"
        },
        lc: {
            meta: "/577/171773/42/62/31033610115062/meta.info",
            lightmap: "/577/171773/42/62/31033610115062/lightmap.webp",
            object: "/577/171773/42/62/31033610115062/object.a3d"
        },
        xt: {
            meta: "/0/16722/167/77/31033610130736/meta.info",
            lightmap: "/0/16722/167/77/31033610130736/lightmap.webp",
            object: "/0/16722/167/77/31033610130736/object.a3d"
        }
    },
    railgun: {
        or: {
            meta: "/567/105205/202/122/31033604741475/meta.info",
            lightmap: "/567/105205/202/122/31033604741475/lightmap.webp",
            object: "/567/105205/202/122/31033604741475/object.a3d"
        },
        pr: {
            meta: "/553/116715/27/132/31033604752652/meta.info",
            lightmap: "/553/116715/27/132/31033604752652/lightmap.webp",
            object: "/553/116715/27/132/31033604752652/object.a3d"
        },
        lc: {
            meta: "/550/121443/145/146/31033604745456/meta.info",
            lightmap: "/550/121443/145/146/31033604745456/lightmap.webp",
            object: "/550/121443/145/146/31033604745456/object.a3d"
        },
        ut: {
            meta: "/556/177362/212/346/31033604754562/meta.info",
            lightmap: "/556/177362/212/346/31033604754562/lightmap.webp",
            object: "/556/177362/212/346/31033604754562/object.a3d"
        },
        gt: {
            meta: "/606/155010/245/142/31033604735353/meta.info",
            lightmap: "/606/155010/245/142/31033604735353/lightmap.webp",
            object: "/606/155010/245/142/31033604735353/object.a3d"
        },
        xt: {
            meta: "/0/16722/6/301/31033604764033/meta.info",
            lightmap: "/0/16722/6/301/31033604764033/lightmap.webp",
            object: "/0/16722/6/301/31033604764033/object.a3d"
        }
    }
};
if (navigator.platform.toLowerCase().includes('mac')) {
    Skins = {
        hornet: {
            or: {
                meta: "/566/70102/323/346/31033607367072/meta.info",
                lightmap: "/566/70102/323/346/31033607367072/lightmap-astc.ktx",
                object: "/566/70102/323/346/31033607367072/object.a3d"
            },
            pr: {
                meta: "/553/1466/317/276/31033607413764/meta.info",
                lightmap: "/553/1466/317/276/31033607413764/lightmap-astc.ktx",
                object: "/553/1466/317/276/31033607413764/object.a3d"
            },
            lc: {
                meta: "/551/32007/310/225/31033607400400/meta.info",
                lightmap: "/551/32007/310/225/31033607400400/lightmap-astc.ktx",
                object: "/551/32007/310/225/31033607400400/object.a3d"
            },
            ut: {
                meta: "/562/165115/303/236/31033610210055/meta.info",
                lightmap: "/562/165115/303/236/31033610210055/lightmap-astc.ktx",
                object: "/562/165115/303/236/31033610210055/object.a3d"
            },
            gt: {
                meta: "/605/27506/77/216/31033607347661/meta.info",
                lightmap: "/605/27506/77/216/31033607347661/lightmap-astc.ktx",
                object: "/605/27506/77/216/31033607347661/object.a3d",
                wheels: "/605/27506/77/216/31033607347661/wheels.webp"
            },
            xt: {
                meta: "/0/16722/6/305/31033607424605/meta.info",
                lightmap: "/0/16722/6/305/31033607424605/lightmap-astc.ktx",
                object: "/0/16722/6/305/31033607424605/object.a3d"
            }
        },
        wasp: {
            or: {
                meta: "/574/111243/33/322/31033607311775/meta.info",
                lightmap: "/574/111243/33/322/31033607311775/lightmap-astc.ktx",
                object: "/574/111243/33/322/31033607311775/object.a3d"
            },
            lc: {
                meta: "/577/171773/42/62/31033610115062/meta.info",
                lightmap: "/577/171773/42/62/31033610115062/lightmap-astc.ktx",
                object: "/577/171773/42/62/31033610115062/object.a3d"
            },
            xt: {
                meta: "/0/16722/167/77/31033610130736/meta.info",
                lightmap: "/0/16722/167/77/31033610130736/lightmap-astc.ktx",
                object: "/0/16722/167/77/31033610130736/object.a3d"
            }
        },
        railgun: {
            or: {
                meta: "/567/105205/202/122/31033604741475/meta.info",
                lightmap: "/567/105205/202/122/31033604741475/lightmap-astc.ktx",
                object: "/567/105205/202/122/31033604741475/object.a3d"
            },
            pr: {
                meta: "/553/116715/27/132/31033604752652/meta.info",
                lightmap: "/553/116715/27/132/31033604752652/lightmap-astc.ktx",
                object: "/553/116715/27/132/31033604752652/object.a3d"
            },
            lc: {
                meta: "/550/121443/145/146/31033604745456/meta.info",
                lightmap: "/550/121443/145/146/31033604745456/lightmap-astc.ktx",
                object: "/550/121443/145/146/31033604745456/object.a3d"
            },
            ut: {
                meta: "/556/177362/212/346/31033604754562/meta.info",
                lightmap: "/556/177362/212/346/31033604754562/lightmap-astc.ktx",
                object: "/556/177362/212/346/31033604754562/object.a3d"
            },
            gt: {
                meta: "/606/155010/245/142/31033604735353/meta.info",
                lightmap: "/606/155010/245/142/31033604735353/lightmap-astc.ktx",
                object: "/606/155010/245/142/31033604735353/object.a3d"
            },
            xt: {
                meta: "/0/16722/6/301/31033604764033/meta.info",
                lightmap: "/0/16722/6/301/31033604764033/lightmap-astc.ktx",
                object: "/0/16722/6/301/31033604764033/object.a3d"
            }
        }
    };
};
var SelectedTank = {
    turret: {},
    hull: {}
};
document.body.insertAdjacentHTML('beforeend', `
<div class='gui3' style="left:150px">
    <h1 style="text-align:center">Skins</h1>
    <label for="Turret"></label>
    <select name="Turret" id="Turret">
    </select>
    <label for="Hull"></label>
    <select name="Hull" id="Hull">
    </select>
</div>
<div class='gui2'>
    <div class="speed-checkbox">
        <div class='info'>(XP XT's) Saves choice on refresh and must be on before joining/refreshing (CLIENT-SIDED ONLY YOU CAN SEE XT)</div>
        <input id='skin-check' class='hotkey' type='checkbox'>
        <label for='skin-check' class="slider"></label>
        <label for='skin-check'>XP XT's</label>
    </div>
    <br>
    <div class="speed-checkbox">
        <input id='speed-check' class='hotkey' type='checkbox'>
        <label for='speed-check' class="slider"></label>
        <label for='speed-check'>Speed</label>
    </div>
    <br>
    <div class="speed-checkbox">
        <input id='aimbot' class='hotkey' type='checkbox' checked>
        <label for='aimbot' class="slider"></label>
        <label for='aimbot'>Aimbot</label>
    </div>
    <br>
    <div class="slider-controls">
        <label for="aim">Aim:</label>
        <input type='range' id="aim" min="0" max="360" value='4'>
        <output id="aim-output" contenteditable="true">4</output>
        <label for="speed">Speed:</label>
        <input type='range' id="speed" min="0" max="100" value='1.13'>
        <output id="speed-output" contenteditable="true">1.13</output>
        <label for="acceleration">Acceleration:</label>
        <input type='range' id="acceleration" min="0" max="100" value='1.15'>
        <output id="acceleration-output" contenteditable="true">1.15</output>
    </div>
</div>

<style>
    .info {
        position: absolute;
        z-index: 1;
        top: -30%;
        background: rgba(255, 2, 2, .2);
        border-radius: 20px;
        width: 200px;
        display: none;
    }

    .speed-checkbox:hover .info {
        display: block;
    }

    .gui2 {
        width: 250px;
        border-radius: 20px;
        border: 2px solid #fff;
        padding: 20px;
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
        justify-content: space-around;
        background: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(8px);
        animation: fadeIn 0.5s ease-out;
        z-index: 9999999999;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }

    .gui3 {
        width: 250px;
        border-radius: 20px;
        border: 2px solid #fff;
        padding: 20px;
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
        justify-content: space-around;
        background: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(8px);
        animation: fadeIn 0.5s ease-out;
        z-index: 9999999999;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }

    .speed-checkbox {
        display: flex;
        align-items: center;
    }

    .speed-checkbox input[type='checkbox'] {
        display: none;
    }

    .speed-checkbox .slider {
        position: relative;
        width: 40px;
        height: 20px;
        background-color: #ccc;
        border-radius: 20px;
        cursor: pointer;
    }

    .speed-checkbox .slider:before {
        position: absolute;
        content: "";
        height: 16px;
        width: 16px;
        left: 2px;
        bottom: 2px;
        background-color: #fff;
        border-radius: 50%;
        transition: 0.4s;
    }

    input[type='checkbox']:checked + .slider:before {
        transform: translateX(20px);
    }

    .speed-checkbox label {
        margin-left: 10px;
        color: #fff;
        font-family: Arial, sans-serif;
    }

    .slider-controls {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .slider-controls label {
        color: #fff;
        font-family: Arial, sans-serif;
    }

    .slider-controls input[type='range'] {
        width: 100%;
        -webkit-appearance: none;
        height: 5px;
        border-radius: 10px;
        background: #bbb;
        outline: none;
        opacity: 0.7;
        -webkit-transition: .2s;
        transition: opacity .2s;
    }

    .slider-controls input[type='range']::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: #fff;
        cursor: pointer;
    }

    .slider-controls input[type='range']::-moz-range-thumb {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: #fff;
        cursor: pointer;
    }

    .slider-controls output {
        color: #fff;
        font-family: Arial, sans-serif;
    }
</style>
`);
function updateAimAmount() {
    try {
        AIM;
    } catch (error) {
        return;
    };
    for (const key in AIM) {
        for (const key2 in AIM[key]) {
            if ((AIM[key][key2].toString() == window.prevAimAmount.toString()) || (AIM[key][key2] == 4)) {
                AIM[key][key2] = window.aimAmount;
                prevAimAmount = aimAmount;
            };
        };
    };
};
localStorage['apap'] = localStorage['apap'] || false;
localStorage['papa'] = localStorage['papa'] || JSON.stringify(SelectedTank);
SelectedTank = JSON.parse(localStorage['papa']);
for (const k in t = Object.entries(Skins?.[Object.entries(SelectedTank.hull)[0][0]])) {
    if (t[k][0] !== 'or') {
        var el = document.createElement('option');
        el.textContent = t[k][0];
        el.value = t[k][0];
        Hull.appendChild(el);
    };
};
for (const k in t = Object.entries(Skins?.[Object.entries(SelectedTank.turret)[0][0]])) {
    if (t[k][0] !== 'or') {
        var el = document.createElement('option');
        el.textContent = t[k][0];
        el.value = t[k][0];
        Turret.appendChild(el);
    };
};
Hull.value = SelectedTank.hull[Object.entries(SelectedTank.hull)[0][0]];
Turret.value = SelectedTank.turret[Object.entries(SelectedTank.turret)[0][0]];
window.Hack = document.getElementById('speed-check').checked;
window.Aimbot = document.getElementById('aimbot').checked;
window.Speed = 1.13;
window.Acceleration = 1.15;
window.aimAmount = 4;
if (localStorage['apap'] == 'true') {
    document.getElementById('skin-check').setAttribute('checked', '');
    var ta = 0;
    var o = fetch;
    var replacements = {};
    for (const k in t = Skins[Object.entries(SelectedTank.turret)[0][0]][SelectedTank.turret[Object.entries(SelectedTank.turret)[0][0]]]) {
        replacements[Skins[Object.entries(SelectedTank.turret)[0][0]].or[k]] = t[k];
    };
    for (const k in t = Skins[Object.entries(SelectedTank.hull)[0][0]][SelectedTank.hull[Object.entries(SelectedTank.hull)[0][0]]]) {
        replacements[Skins[Object.entries(SelectedTank.hull)[0][0]].or[k]] = t[k];
    };
    fetch = function() {
        for (let key in replacements) {
            if (arguments[0].includes(key)) {
                ta++;
                arguments[0] = arguments[0].replace(key, replacements[key]);
                if (ta > 5) {
                    console.log('Restoring original fetch function:', o);
                    fetch = o;
                };
            };
        };
        return o.apply(this, arguments);
    };
};

// Get references to the output elements
const speedOutput = document.getElementById('speed-output');
const accelerationOutput = document.getElementById('acceleration-output');
const aimOutput = document.getElementById('aim-output');

// Add event listeners to handle user input
speedOutput.addEventListener('input', function () {
    let value = parseFloat(this.textContent);
    value = Math.max(0, Math.min(100, value));
    document.getElementById('speed').value = value;
    window.Speed = value;
});

accelerationOutput.addEventListener('input', function () {
    let value = parseFloat(this.textContent);
    value = Math.max(0, Math.min(100, value));
    document.getElementById('acceleration').value = value;
    window.Acceleration = value;
});

aimOutput.addEventListener('input', function () {
    let value = parseFloat(this.textContent);
    value = Math.max(0, Math.min(360, value));
    document.getElementById('aim').value = value;
    window.aimAmount = value;
    updateAimAmount();
});

document.getElementById('speed').addEventListener('input', function () {
    speedOutput.textContent = this.value;
    window.Speed = parseFloat(this.value);
});

document.getElementById('acceleration').addEventListener('input', function () {
    accelerationOutput.textContent = this.value;
    window.Acceleration = parseFloat(this.value);
});

document.getElementById('aim').addEventListener('input', function () {
    aimOutput.textContent = this.value;
    window.aimAmount = parseFloat(this.value);
    updateAimAmount();
});

document.getElementById('speed-check').addEventListener('change', function () {
    window.Hack = this.checked;
});

document.getElementById('aimbot').addEventListener('change', function () {
    window.Aimbot = this.checked;
});

document.getElementById('skin-check').addEventListener('change', function () {
    localStorage['apap'] = this.checked;
});

Hull.addEventListener('change', () => {
    SelectedTank.hull[User.hull.name.toLowerCase()] = Hull.value;
    localStorage['papa'] = JSON.stringify(SelectedTank);
    for (const k in SelectedTank.turret) {
        if (k !== User.turret.name.toLowerCase()) {
            delete SelectedTank.turret[k];
        };
    };
    for (const k in SelectedTank.hull) {
        if (k !== User.hull.name.toLowerCase()) {
            delete SelectedTank.hull[k];
        };
    };
});

Turret.addEventListener('change', () => {
    SelectedTank.turret[User.turret.name.toLowerCase()] = Turret.value;
    localStorage['papa'] = JSON.stringify(SelectedTank);
    for (const k in SelectedTank.turret) {
        if (k !== User.turret.name.toLowerCase()) {
            delete SelectedTank.turret[k];
        };
    };
    for (const k in SelectedTank.hull) {
        if (k !== User.hull.name.toLowerCase()) {
            delete SelectedTank.hull[k];
        };
    };
});

document.addEventListener('keydown', (e) => {
    if (e.ctrlKey && e.key == 'm') {
        document.querySelector('.gui2').style.display = document.querySelector('.gui2').style.display == 'block' ? 'none' : 'block';
        document.querySelector('.gui3').style.display = document.querySelector('.gui3').style.display == 'block' ? 'none' : 'block';
    };
});
setInterval(() => {
    updateAimAmount();
}, 2000);
var f, r = true;
function a() {
    if (r) {
        f = requestAnimationFrame(a);
        if (User?.turret?.name) {
            document.querySelector('label[for="Turret"]').textContent = User.turret.name;
            document.querySelector('label[for="Hull"]').textContent = User.hull.name;
            for (const k in SelectedTank.turret) {
                if (k !== User.turret.name.toLowerCase()) {
                    delete SelectedTank.turret[k];
                };
            };
            for (const k in SelectedTank.hull) {
                if (k !== User.hull.name.toLowerCase()) {
                    delete SelectedTank.hull[k];
                };
            };
            SelectedTank.hull[User.hull.name.toLowerCase()] = Hull.value;
            SelectedTank.turret[User.turret.name.toLowerCase()] = Turret.value;
            localStorage['papa'] = JSON.stringify(SelectedTank);
            Hull.innerHTML = '';
            Turret.innerHTML = '';
            for (const k in t = Object.entries(Skins?.[User.hull.name.toLowerCase()])) {
                if (t[k][0] !== 'or') {
                    var el = document.createElement('option');
                    el.textContent = t[k][0];
                    el.value = t[k][0];
                    Hull.appendChild(el);
                };
            };
            for (const k in t = Object.entries(Skins?.[User.turret.name.toLowerCase()])) {
                if (t[k][0] !== 'or') {
                    var el = document.createElement('option');
                    el.textContent = t[k][0];
                    el.value = t[k][0];
                    Turret.appendChild(el);
                };
            };
            localStorage['papa'] = JSON.stringify(SelectedTank);
            cancelAnimationFrame(f);
            r = false;
        };
    };
};
try {
    a();
} catch (error) {
    console.log(error);
    r = false;
    cancelAnimationFrame(f);
};
